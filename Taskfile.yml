version: "3"
vars:
  USER_SERVICE_DIR: user-service
  PRODUCT_SERVICE_DIR: product-service
  INVENTORY_SERVICE_DIR: inventory-service
  API_GATEWAY_DIR: api-gateway

tasks:
  default:
    desc: Show all available tasks
    cmds:
      - task --list
  install:
    desc: Install dependencies for all services
    cmds:
      - task: install-user
      - task: install-product
      - task: install-gateway
      - task: install-inventory
  dev:
    desc: Start all services in development mode
    deps:
      - dev-user
      - dev-product
      - dev-gateway
      - dev-inventory
  install-user:
    desc: Install User Service dependencies
    dir: "{{.USER_SERVICE_DIR}}"
    cmds:
      - npm install

  install-product:
    desc: Install Product Service dependencies
    dir: "{{.PRODUCT_SERVICE_DIR}}"
    cmds:
      - pip install -r requirements.txt

  install-gateway:
    desc: Install API Gateway dependencies
    dir: "{{.API_GATEWAY_DIR}}"
    cmds:
      - go mod tidy

  install-inventory:
    desc: Install Inventory Service dependencies
    dir: "{{.INVENTORY_SERVICE_DIR}}"
    cmds:
      - pip install -r requirements.txt

  dev-user:
    desc: Start User Service in development mode
    dir: "{{.USER_SERVICE_DIR}}"
    cmds:
      - npm run start:dev

  dev-product:
    desc: Start Product Service in development mode
    dir: "{{.PRODUCT_SERVICE_DIR}}"
    cmds:
      - python product_service.py

  dev-gateway:
    desc: Start API Gateway in development mode
    dir: "{{.API_GATEWAY_DIR}}"
    cmds:
      - go run main.go

  dev-inventory:
    desc: Start Inventory Service in development mode
    dir: "{{.INVENTORY_SERVICE_DIR}}"
    cmds:
      - python inventory_service.py
